<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Cosmic Receipt</title>
  
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="apple-mobile-web-app-status-bar-style" content="white">
  <meta name="theme-color" content="#e3f2fd">

  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@600;700&family=Courier+Prime&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg: linear-gradient(135deg, #e3f2fd, #f3e5f5);
      --card-bg: rgba(255, 255, 255, 0.85);
      --accent: #9c27b0;
      --text: #4a148c;
    }

    body {
      margin: 0;
      height: 100vh;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-family: "Quicksand", sans-serif;
      -webkit-tap-highlight-color: transparent;
      overflow: hidden;
      transition: background 0.5s;
    }

    .controls {
      background: var(--card-bg);
      backdrop-filter: blur(15px);
      padding: 25px;
      border-radius: 30px;
      display: flex;
      flex-direction: column;
      gap: 15px;
      width: 80%;
      max-width: 300px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.1);
      border: 2px solid #fff;
    }

    input, select {
      border: 2px solid var(--accent);
      background: #fff;
      padding: 15px;
      border-radius: 15px;
      font-family: "Quicksand", sans-serif;
      font-weight: 700;
      color: var(--text);
      font-size: 1rem;
      outline: none;
      text-align: center;
      width: 100%;
      box-sizing: border-box; /* Fixes padding issues */
    }

    /* Custom Arrow for Select Dropdown */
    select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%239c27b0%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
      background-repeat: no-repeat;
      background-position: right 15px top 50%;
      background-size: 12px auto;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      padding: 16px;
      border-radius: 999px;
      font-family: "Quicksand", sans-serif;
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      transition: transform 0.2s;
    }
    button:active { transform: scale(0.95); }

    /* RECEIPT STYLES */
    .receipt-container {
      perspective: 1000px;
      width: 85%;
      max-width: 340px;
      display: none;
    }

    .receipt {
      background: #fff;
      padding: 25px 20px;
      font-family: "Courier Prime", monospace;
      color: #37474f;
      box-shadow: 0 20px 50px rgba(0,0,0,0.15);
      animation: printReceipt 0.8s cubic-bezier(0.2, 0.8, 0.2, 1) forwards;
      
      --mask: radial-gradient(10px at 50% 100%, #0000 98%, #000 100%) 50% calc(100% - 10px)/20px 100% repeat-x;
      -webkit-mask: var(--mask); 
      mask: var(--mask);
      padding-bottom: 50px;
    }

    @keyframes printReceipt {
      0% { height: 0; opacity: 0; transform: translateY(-50px); }
      100% { height: auto; opacity: 1; transform: translateY(0); }
    }

    .header { text-align: center; border-bottom: 2px dashed #b0bec5; padding-bottom: 15px; margin-bottom: 15px; }
    .header h2 { margin: 0; font-size: 1.5rem; color: var(--accent); letter-spacing: 2px; }
    
    .item { display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 0.9rem; }
    
    .total { margin-top: 20px; border-top: 2px dashed #b0bec5; padding-top: 15px; display: flex; justify-content: space-between; font-weight: bold; }
    
    .secret-hint {
      margin-top: 25px; text-align: center; font-size: 0.7rem; color: var(--accent); opacity: 0.8; font-weight: bold;
    }

    .barcode { margin-top: 10px; text-align: center; font-size: 1.5rem; opacity: 0.5; letter-spacing: -3px; }
  </style>
</head>
<body>

  <div class="controls" id="controls">
    <input type="text" id="nameInput" placeholder="Name or Secret Code">
    
    <select id="zodiacInput">
      <option value="" disabled selected>Select Your Sign</option>
      <option value="fire">Aries / Leo / Sag</option>
      <option value="earth">Taurus / Virgo / Cap</option>
      <option value="air">Gemini / Libra / Aqua</option>
      <option value="water">Cancer / Scorpio / Pisces</option>
    </select>

    <button onclick="generate()">♡ PRINT RECEIPT ♡</button>
  </div>

  <div class="receipt-container" id="receiptContainer">
    <div class="receipt">
      <div class="header">
        <h2 id="storeName">COSMIC STORE</h2>
        <div id="dateLine"></div>
      </div>

      <div id="itemList"></div>

      <div class="total">
        <span>TOTAL:</span>
        <span id="totalText">100% CUTE</span>
      </div>

      <div class="secret-hint" id="secretHint"></div>
      
      <div class="barcode">|| ||| || ||||| ||</div>
    </div>
    <div style="text-align:center; color:white; font-size:0.8rem; margin-top:15px; opacity:0.8;">( tap receipt to reset )</div>
  </div>

  <script>
    // --- 1. ZODIAC SPECIFIC ITEMS ---
    const zodiacItems = {
      fire: [ // Aries, Leo, Sag
        {name: "Main Character Energy", price: "priceless"},
        {name: "Impulse Buy", price: "$50.00"},
        {name: "Being Loud", price: "Free"},
        {name: "God Complex", price: "Tax incl."},
        {name: "Starting Drama", price: "$0.00"}
      ],
      earth: [ // Taurus, Virgo, Cap
        {name: "Nap Time", price: "4hrs"},
        {name: "Organizing", price: "satisfying"},
        {name: "Overthinking", price: "Tax incl."},
        {name: "Expensive Taste", price: "$$$"},
        {name: "Judging People", price: "Free"}
      ],
      air: [ // Gemini, Libra, Aqua
        {name: "Ghosting", price: "oops"},
        {name: "Yap Session", price: "3hrs"},
        {name: "Indecision", price: "forever"},
        {name: "New Hobby", price: "$100.00"},
        {name: "Fake Scenario", price: "Free"}
      ],
      water: [ // Cancer, Scorpio, Pisces
        {name: "Crying", price: "$0.00"},
        {name: "Intuition", price: "scary"},
        {name: "Revenge Plot", price: "pending"},
        {name: "Emotional Support", price: "$5.00"},
        {name: "Yearning", price: "always"}
      ]
    };

    const commonItems = [
      {name: "Iced Coffee", price: "$7.50"},
      {name: "Sweet Treat", price: "$4.00"},
      {name: "Lip Gloss", price: "$12.00"},
      {name: "Spotify Premium", price: "$11.00"},
      {name: "Girl Dinner", price: "$8.00"}
    ];

    // --- 2. SECRET CODES ---
    const secrets = {
      "moon": { theme: "linear-gradient(to bottom, #0f2027, #203a43, #2c5364)", color: "#4facfe", store: "MOON CHILD" },
      "love": { theme: "linear-gradient(to bottom, #ff9a9e, #fecfef)", color: "#ff6fae", store: "LOVER GIRL" },
      "rich": { theme: "linear-gradient(to bottom, #d4fc79, #96e6a1)", color: "#2e7d32", store: "OLD MONEY" }
    };

    // Hints to print at bottom to help user find codes
    const hints = [
      "Psst... try typing 'moon' next time.",
      "Unlock pink mode? Type 'love'.",
      "Feeling lucky? Type 'rich'.",
      "Your vibe is immaculate.",
      "Don't forget to drink water."
    ];

    function generate() {
      const name = document.getElementById('nameInput').value.toLowerCase().trim();
      const zodiacGroup = document.getElementById('zodiacInput').value;
      
      // 1. Check for Secret Code
      if (secrets[name]) {
        // Unlock Secret Theme
        const s = secrets[name];
        document.documentElement.style.setProperty('--bg', s.theme);
        document.documentElement.style.setProperty('--accent', s.color);
        document.documentElement.style.setProperty('--text', s.color);
        document.getElementById('storeName').innerText = s.store;
      } else {
        // Default Theme (Reset)
        document.documentElement.style.setProperty('--bg', "linear-gradient(135deg, #e3f2fd, #f3e5f5)");
        document.documentElement.style.setProperty('--accent', "#9c27b0");
        document.getElementById('storeName').innerText = "COSMIC STORE";
      }

      // 2. Build the Item List
      let pool = commonItems;
      if (zodiacGroup && zodiacItems[zodiacGroup]) {
        // Mix common items with zodiac specific items
        pool = [...commonItems, ...zodiacItems[zodiacGroup]];
      }

      // Pick 3-5 random items
      const count = Math.floor(Math.random() * 3) + 3;
      const shuffled = pool.sort(() => 0.5 - Math.random());
      const selected = shuffled.slice(0, count);

      let html = '';
      selected.forEach(i => {
        html += `<div class="item"><span>${i.name}</span><span>${i.price}</span></div>`;
      });
      document.getElementById('itemList').innerHTML = html;

      // 3. Set Date & Hint
      document.getElementById('dateLine').innerText = new Date().toLocaleString();
      
      // Random hint at bottom
      const randomHint = hints[Math.floor(Math.random() * hints.length)];
      document.getElementById('secretHint').innerText = randomHint;

      // Show Receipt
      document.getElementById('controls').style.display = 'none';
      document.getElementById('receiptContainer').style.display = 'block';
    }

    // Reset on click
    document.getElementById('receiptContainer').addEventListener('click', () => {
      document.getElementById('controls').style.display = 'flex';
      document.getElementById('receiptContainer').style.display = 'none';
      document.getElementById('nameInput').value = ""; // Clear for next code
    });

    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
  </script>
</body>
</html>
